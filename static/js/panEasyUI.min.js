

$.fn.extend({onMouseWheel:function(t){$(this).on("mousewheel DOMMouseScroll",function(i){"function"==typeof i.preventDefault&&i.preventDefault();var o=i.originalEvent.detail,n=i.originalEvent.wheelDelta;return t(i,void 0===n?-o:n),!1})}}),$.fn.extend({panScrollBar:function(t){var i=$.extend({},{width:400,height:350,scroll_x_width:7,scroll_x_color:"#ddd",scroll_x_radius:7,scroll_x_thumb_color:"#aaa",scroll_x_thumb_radius:7,scroll_x_overflow:"auto",scroll_y_width:7,scroll_y_radius:7,scroll_y_color:"#ddd",scroll_y_thumb_color:"#aaa",scroll_y_thumb_radius:7,scroll_y_overflow:"auto",inertia_dis:100},t),o=$(this).html(),n='<div class="scroll-content"></div><div class="scroll-x-bar"><div class="scrollbar-x-thumb"></div></div>';n+='<div class="scroll-y-bar"><div class="scrollbar-y-thumb"></div></div><div class="scroll-over-layer"></div>',$(this).html(n);var e=$(this),s=$(this).find(".scroll-content");s.html(o);var c=$(this).find(".scroll-x-bar"),l=$(this).find(".scroll-y-bar"),a=c.find(".scrollbar-x-thumb"),d=l.find(".scrollbar-y-thumb"),r=$(this).find(".scroll-over-layer"),f=s.width(),h=s.height();$(this).css({width:i.width+"px",height:i.height+"px",overflow:"hidden"}),r.css({width:i.width+"px",height:i.height-i.scroll_y_width+"px"}),l.css({height:i.height+"px",width:i.scroll_y_width+"px",left:i.width-i.scroll_y_width+"px","background-color":i.scroll_y_color,"border-radius":i.scroll_y_radius+"px"}),c.css({height:i.scroll_x_width+"px",width:i.width+"px",top:i.height-i.scroll_x_width+"px","background-color":i.scroll_x_color,"border-radius":i.scroll_x_radius+"px"});var p={scrollY:!1,scrollX:!1};"auto"==i.scroll_y_overflow?(!function(){function t(){o+=u,r+=v,u>0&&o>=m?(o=m,clearInterval(p)):u<0&&o<=m&&(o=m,clearInterval(p)),s.css({"margin-top":o+"px"}),d.css({"margin-top":r+"px"})}var o=0;if(h<=i.height)l.css("display","none");else{var n=h-i.height,c=1*i.height/h,a=parseInt(i.height*c),r=0,f=i.height-a;d.css({height:a+"px","background-color":i.scroll_y_thumb_color,"border-radius":i.scroll_y_thumb_radius+"px"});var p=null,u=2,m=0,v=f*u*1/n;e.onMouseWheel(function(e,s){if(p&&clearInterval(p),s>0){if(u=Math.abs(u),m=o+i.inertia_dis,o>=0)return;m>0&&(m=0),v=-Math.abs(v),p=setInterval(t,1)}else{if(u=-Math.abs(u),m=o-i.inertia_dis,o<=-n)return;m<-n&&(m=-n),v=Math.abs(v),p=setInterval(t,1)}})}}(),p.scrollY=!0):l.css("display","none"),"auto"==i.scroll_x_overflow?(!function(){console.log(f+"==="+i.width);var t=0;if(f<=i.width)c.css("display","none");else{var o=f-i.width,n=1*i.width/f,e=parseInt(i.width*n),l=0,d=i.width-e,r=d/o;a.css({width:e+"px","background-color":i.scroll_x_thumb_color,"border-radius":i.scroll_x_thumb_radius+"px"});var h=0,p=0,u=0,m=0,v=!1;a.on("mousedown",function(i){p=i.pageX,m=l,h=t,v=!0,s.addClass("not-selected")}),$(window).on("mousemove",function(i){v&&(u=i.pageX,t=h+(p-u)/r,(l=m+u-p)>=d?(l=d,t=-o):l<=0&&(l=0,t=0),a.css({"margin-left":l+"px"}),s.css({"margin-left":t+"px"}))}),$(window).on("mouseup",function(){v=!1,s.removeClass("not-selected")})}}(),p.scrollX=!0):c.css("display","none")}}),$.fn.extend({selectorInit:function(t,i){var o=$.extend({},{width:280,expandType:"touch",optionsHeight:200,text:{tId:"demo",tName:"demo"},options:[{tId:"demo",tName:"demo"},{tId:"demo",tName:"demo"},{tId:"demo",tName:"demo"},{tId:"demo",tName:"demo"}]},t),n="";n+='<div class="pan-text" tId="'+o.text.tId+'">'+o.text.tName+"</div>",n+='<div class="pan-btn"><span></span></div>',n+='<div class="pan-scroll-box">';for(var e in o.options)n+='<div class="item-li" tId="'+o.options[e].tId+'">'+o.options[e].tName+"</div>";n+="</div>",$(this).html(n);var s=$(this);$(this).css("width",o.width+"px"),s.find(".pan-text").css({width:o.width-36+"px"});var c=$(this).find(".pan-scroll-box");c.panScrollBar({width:o.width,height:o.optionsHeight}),c.css({position:"absolute",left:"-1px",top:"29px","background-color":"#fff","z-index":"10001",border:"1px solid #80bc71",display:"none"}),"click"==o.expandType?s.on("click",function(){c.css("display","block")}):"touch"==o.expandType&&s.on("mouseenter",function(){c.css("display","block")}),s.on("mouseleave",function(){c.css("display","none")}),s.on("click",".item-li",function(){if(s.find(".pan-text").html($(this).html()),s.find(".pan-text").attr("tId",$(this).attr("tId")),c.css("display","none"),"function"==typeof i){var t=s.find(".pan-text").attr("tId"),o=s.find(".pan-text").html();i({tId:t,tName:o})}})}}),$("#test_selector").selectorInit({width:280,expandType:"touch",optionsULHeight:360,text:{tId:"上海",tName:"上海"},options:[{tId:"上海",tName:"上海"},{tId:"北京",tName:"北京"},{tId:"深圳",tName:"深圳"},{tId:"江苏",tName:"江苏"},{tId:"山东",tName:"山东"},{tId:"广东",tName:"广东"},{tId:"江西",tName:"江西"},{tId:"南京",tName:"南京"},{tId:"江苏",tName:"江苏"},{tId:"陕西",tName:"陕西"},{tId:"河南",tName:"河南"},{tId:"河北",tName:"河北"},{tId:"山西",tName:"山西"},{tId:"天津",tName:"天津"}]},function(t){console.log(JSON.stringify(t))}),$("#test_selector1").selectorInit({width:120,text:{tId:"火星",tName:"火星"},options:[{tId:"火星",tName:"火星"},{tId:"木星",tName:"木星"},{tId:"水星",tName:"水星"},{tId:"金星",tName:"金星"},{tId:"天王星",tName:"天王星"},{tId:"海王星",tName:"海王星"},{tId:"冥王星",tName:"冥王星"},{tId:"地球",tName:"地球"},{tId:"太阳",tName:"太阳"}]},function(t){console.log(JSON.stringify(t))}),$.fn.extend({ZoomInit:function(t){function i(t){return{filter:"alpha(opacity=50)","-moz-opacity":t+="","-khtml-opacity":t,opacity:t}}var o=$(this);$(this).append('<div class="imageBg"></div>'),$imageBg=o.find("div.imageBg");var n=$(this).find("img");t.imageWidth&&"number"==typeof t.imageWidth&&n.css("width",t.imageWidth+"px"),t.imageHeight&&"number"==typeof t.imageHeight&&n.css("height",t.imageHeight+"px");var e=2;t.scale&&"number"==typeof t.scale&&(e=t.scale);var s=$(document).width(),c=$(document).height(),l=n.width(),a=n.height(),d=o.offset().left,r=o.offset().top,f=l*e,h=a*e;(f>=s||h>=c)&&(h=1*a/l*(f=.8*s));var p=(s-f)/2,u=(c-h)/2;o.css("width",l+"px"),o.css("height",a+"px"),$imageBg.css({width:"100%",height:"100%",position:"absolute",left:"0",top:"0","background-color":"#666",display:"none","z-index":1e3});var m=!1;n.on("click",function(){m?(d=o.offset().left,r=o.offset().top,$imageBg.animate(i(0),250,function(){$imageBg.css("display","none")}),n.animate({width:l+"px",height:a+"px",left:d+"px",top:r+"px"},250,function(){m=!1,n.css("position","static")})):(n.css("position","absolute"),n.css("z-index","1001"),console.log(n.offset().top),$imageBg.css("display","block"),$imageBg.css(i(0)),$imageBg.animate(i(.5),250),n.animate({width:f+"px",height:h+"px",left:p+"px",top:u+"px"},250,function(){m=!0}))}),n.on("mouseenter",function(){m?n.css("cursor","zoom-out"):n.css("cursor","zoom-in")})}}),$.fn.extend({panDateTimePicker:function(t){function i(t,i){f.find(".year-text").html(t),f.find(".month-text").html(i),o[2]=t%400==0||t%4==0&&t%100!=0?29:28;for(var n=function(t,i,o){return new Date(t+"/"+i+"/"+o).getDay()}(t,i,1),e="",s=o[i],c=0;c<7;c++)c<n&&(e+='<span style="visibility:hidden">&nbsp;</span>');for(c=1;c<=s;c++)e+="<span>"+c+"</span>";f.find(".picker-days").html(e)}var o=[null,31,29,31,30,31,30,31,31,30,31,30,31],n=["日","一","二","三","四","五","六"],e=$.extend({},{start_year:1990,end_year:2030,format:"mm/dd/yyyy"},t),s=new Date,c=s.getFullYear(),l=s.getMonth()+1;s.getDate();$(this).html('<label class="date-show"></label>'),$(this).append('<div class="picker-box"></div>');var a='<div class="picker-header">';a+='<div class="left-btn"></div>',a+='<div class="year-selector"><a class="year-text">2017</a><span class="year-btn"></span>',a+='<div class="pan-scroll-box" id="year-list"></div></div>',a+='<div class="month-selector"><a class="month-text">09</a><span class="month-btn"></span>',a+='<div class="pan-scroll-box" id="month-list"></div></div>',a+='<div class="right-btn"></div>',a+="</div>",a+='<div class="picker-week">';for(var d=0;d<7;d++)a+="<span>"+n[d]+"</span>";a+="</div>",a+='<div class="picker-days"></div>',$(this).find(".picker-box").html(a),a="";var r=0;for(d=e.start_year;d<=e.end_year;d++)a+='<div class="item-li" style="width:60px;">'+d+"</div>",r++;$(this).find("#year-list").html(a),a="";for(d=1;d<=12;d++)a+='<div class="item-li" style="width:45px;">'+d+"</div>";$(this).find("#month-list").html(a);var f=$(this),h=$(this).find("#year-list"),p=240<20*r?240:20*r;h.panScrollBar({width:60,height:p}),h.css({position:"absolute",border:"1px solid #80bc71","background-color":"#fff",top:"20px",left:"-5px","z-index":"20001",display:"none"});var u=$(this).find("#month-list");u.panScrollBar({width:45,height:240}),u.css({position:"absolute",border:"1px solid #80bc71","background-color":"#fff",top:"20px",left:"-5px","z-index":"20001",display:"none"}),i(c,l),$(this).find(".year-selector").on("mouseenter",function(){h.css("display","block")}),$(this).find(".year-selector").on("mouseleave",function(){h.css("display","none")}),h.on("click",".item-li",function(){var t=$(this).html(),o=f.find(".month-text").html();f.find(".year-text").html(t),h.css("display","none"),i(parseInt(t),parseInt(o))}),$(this).find(".month-selector").on("mouseenter",function(){u.css("display","block")}),$(this).find(".month-selector").on("mouseleave",function(){u.css("display","none")}),f.find(".picker-box").css({display:"none"}),u.on("click",".item-li",function(){var t=f.find(".year-text").html(),o=$(this).html();f.find(".month-text").html(o),u.css("display","none"),i(parseInt(t),parseInt(o))}),$(this).find(".picker-days").on("click","span",function(){var t=f.find(".year-text").html(),i=f.find(".month-text").html(),o=$(this).html();f.find(".date-show").html(function(t,i,o){"string"==typeof i&&(i=parseInt(i)),"string"==typeof o&&(o=parseInt(o)),i=i<10?"0"+i:i,o=o<10?"0"+o:o;var n="";return"yyyy-mm-dd"==e.format?n=t+"-"+i+"-"+o:"mm/dd/yyyy"==e.format?n=i+"/"+o+"/"+t:"yyyy/mm/dd"==e.format&&(n=t+"/"+i+"/"+o),n}(t,i,o)),f.find(".picker-box").css("display","none")}),$(this).find(".date-show").on("click",function(){f.find(".picker-box").css("display","block")})}}),$.fn.extend({panColorPicker:function(t,o){function n(t){if(!isNaN(t)){var i=parseInt(1*t/D*C);s({r:255,g:255,b:255},H=N[i=(i=i<0?0:i)>C-1?C-1:i],{r:0,g:0,b:0},d)}}function e(t,i){if(!isNaN(i)&&!isNaN(t)){var o=function(t,i,o,n,e,s){var c=parseInt(1*(i.r-t.r)/n*e+t.r),l=parseInt(1*(i.g-t.g)/n*e+t.g),a=parseInt(1*(i.b-t.b)/n*e+t.b),d=parseInt(1*(o.r-c)/n*s+c),r=parseInt(1*(o.g-l)/n*s+l),f=parseInt(1*(o.b-a)/n*s+a);return d=d>255?255:d,r=r>255?255:r,f=f>255?255:f,{r:d,g:r,b:f}}({r:255,g:255,b:255},H,{r:0,g:0,b:0},d,S,z);F=o,g.html(o.r+","+o.g+","+o.b),y.css("background-color",l(o.r,o.g,o.b)),x.html(l(o.r,o.g,o.b))}}function s(t,i,o,n){for(var e=[],s=1*(i.r-t.r)/n,c=1*(i.g-t.g)/n,l=1*(i.b-t.b)/n,a=0;a<n;a++)e.push({r:parseInt(t.r+s*a),g:parseInt(t.g+c*a),b:parseInt(t.b+l*a)});for(a=0;a<n;a++)for(var d=0;d<n;d++){var r=4*a*n+4*d;Y.data[r]=parseInt(1*(o.r-e[d].r)/n*a+e[d].r),Y.data[r+1]=parseInt(1*(o.g-e[d].g)/n*a+e[d].g),Y.data[r+2]=parseInt(1*(o.b-e[d].b)/n*a+e[d].b),Y.data[r+3]=255}W.putImageData(Y,0,0)}function c(t){var i=[];return i.push(parseInt(t.substr(1,2),16)),i.push(parseInt(t.substr(3,2),16)),i.push(parseInt(t.substr(5,2),16)),i}function l(t,i,o){var n=t.toString(16),e=i.toString(16),s=o.toString(16);return n=1==n.length?"0"+n:n,e=1==e.length?"0"+e:e,s=1==s.length?"0"+s:s,"#"+n+e+s}var a=$.extend({},{width:50,height:26,borderColor:"#333",iconBorderColor:"#333",iconColor:"#ff0000"},t),d=180,r="";r+='<div class="cur_color"></div><div class="arrow_btn"></div>',r+='<div class="picker_box">',r+='<div class="panel_box"><canvas class="color_canvas" width="'+d+'" height="'+d+'"></canvas>',r+='<div class="canvas_point"></div>',r+='<div class="rainbow_panel"><span></span></div></div>',r+='<div class="op_box"><div class="pre_color"></div><div class="now_color"></div>',r+='<div class="rgb_value">255,0,0</div><div class="hex_value">#ff0000</div>',r+='<div class="cancel_btn">取消</div><div class="ok_btn">确定</div></div>',r+="</div>",$(this).append(r);var f=$(this).find(".picker_box"),h=$(this).find(".arrow_btn"),p=$(this).find(".color_canvas"),u=$(this).find(".canvas_point"),m=$(this).find(".rainbow_panel"),v=$(this).find(".rainbow_panel").find("span"),g=$(this).find(".rgb_value"),x=$(this).find(".hex_value"),b=$(this).find(".cur_color"),_=$(this).find(".pre_color"),y=$(this).find(".now_color"),w=$(this).find(".ok_btn"),I=$(this).find(".cancel_btn");f.css({display:"none"}),$(this).css({"border-color":a.borderColor,width:a.width+"px",height:a.height+"px"}),b.css({"background-color":a.iconColor,height:a.height-6+"px","border-color":a.iconBorderColor}),_.css("background-color",a.iconColor);for(var k=["#ff0000","#FF8000","#ffff00","#00ff00","#00ffff","#0000ff","#8000ff"],N=[],C=0,B=1;B<7;B++)gradient_list=function(t,o,n,e){var s=c(t),a=c(o),d=1*(a[0]-s[0])/n,r=1*(a[1]-s[1])/n,f=1*(a[2]-s[2])/n,h=[];for(i=0;i<n;i++){var p=parseInt(s[0]+d*i),u=parseInt(s[1]+r*i),m=parseInt(s[2]+f*i);p=p>255?255:p,u=u>255?255:u,m=m>255?255:m,1==e?h.push(l(p,u,m)):h.push({r:p,g:u,b:m})}return h}(k[B-1],k[B],30),$.merge(N,gradient_list,!1);C=N.length;var D=d,z=0,S=0,M=0,F={r:0,g:0,b:0},H={r:255,g:0,b:0},W=p[0].getContext("2d"),Y=W.createImageData(d,d);s({r:255,g:255,b:255},H,{r:0,g:0,b:0},180),function(){function t(t){S=t.pageX-p.offset().left,z=t.pageY-p.offset().top,S=S<0?0:S,z=z<0?0:z;var i=S>d-3?d-3:S-2,o=z>d-3?d-3:z-2;S=S>d?d:S,z=z>d?d:z,u.css({top:o+"px",left:i+"px"}),e(S,z)}function i(t){document.onmousemove=null,document.onmouseup=null,document.onselectstart=null}u.on("mousedown",function(t){p.mousedown()}),p.on("mousedown",function(o){S=o.pageX-p.offset().left,z=o.pageY-p.offset().top,u.css({top:z+"px",left:S+"px"}),document.onmousemove=t,document.onmouseup=i,document.onselectstart=function(){return!1},e(S,z)})}(),function(){function t(t){M=(M=(M=t.pageY-p.offset().top)<0?0:M)>D-4?D-4:M,v.css("top",M+"px"),n(M),e(S,z)}function i(t){document.onmousemove=null,document.onmouseup=null,document.onselectstart=null}v.on("mousedown",function(t){m.mousedown()}),m.on("mousedown",function(o){M=(M=(M=o.pageY-p.offset().top)<0?0:M)>D-4?D-4:M,document.onmousemove=t,document.onmouseup=i,document.onselectstart=function(){return!1},v.css("top",M+"px"),n(M),e(S,z)})}(),w.on("click",function(){"function"==typeof o&&(t={hex:x.html(),rgb:F},o(t),f.css({display:"none"}),b.css("background-color",x.html()),_.css("background-color",x.html()))}),I.on("click",function(){f.css("display","none"),console.log("none")}),b.click(function(){f.css({display:"block"}),f.css({display:"block"})}),h.click(function(){b.click()})}}),$("#test_color_picker").panColorPicker({},function(t){console.log(t)}),$.fn.extend({panEditFrame:function(t){$.extend(t,{},{});var i=["宋体","黑体","新宋体","仿宋","楷体","幼圆"],o={"初号":"9","一号":"8","二号":"7","三号":"6","小三":"5","四号":"4","小四":"3","五号":"2","小五":"1"},n='<div class="tool">';n+='<div class="first_row"><select class="family"></select>',n+='<select class="fontsize"></select>',n+='<span class="bold" title="粗体">B</span>',n+='<span class="italic" title="斜体">I</span>',n+='<div class="text_left" title="左对齐"></div>',n+='<div class="text_center" title="居中对齐"></div>',n+='<div class="text_right" title="右对齐"></div>',n+='<div class="reply_left" title="撤销"></div>',n+='<div class="reply_right" title="恢复撤销"></div>',n+='<div class="indent" title="增加缩进"></div>',n+='<div class="outdent" title="减少缩进"></div>',n+='<div class="underline" title="下划线"></div>',n+='<div class="deleteline" title="删除线"></div>',n+='<div class="remove_format" title="清除格式"></div>',n+='<div class="code_format" title="代码格式化"></div>',n+="</div>",n+='<div class="second_row">',n+='<div class="pan-color-picker"></div>',n+="</div>",n+="</div>",$(this).append(n),$(this).append('<iframe class="edit" spellcheck="false"></iframe>'),n='<div class="code_dialog">',n+='<div class="dialog_header"><span class="dialog_close">×</span></div><textarea class="dialog_content"></textarea>',n+='<div class="dialog_ok_btn">确定</div>',$(this).append(n);var e=$(this).find(".family"),s=$(this).find(".fontsize"),c=$(this).find(".edit"),l=$(this).find(".bold"),a=$(this).find(".italic"),d=$(this).find(".text_left"),r=$(this).find(".text_center"),f=$(this).find(".text_right"),h=$(this).find(".reply_left"),p=$(this).find(".reply_right"),u=$(this).find(".indent"),m=$(this).find(".outdent"),v=$(this).find(".underline"),g=$(this).find(".deleteline"),x=$(this).find(".remove_format"),b=$(this).find(".code_format"),_=$(this).find(".pan-color-picker"),y=$(this).find(".code_dialog"),w=$(this).find(".dialog_content"),I=$(this).find(".dialog_close"),k=$(this).find(".dialog_ok_btn");_.panColorPicker({width:50,height:24,borderColor:"#ccc",iconBorderColor:"#ccc",iconColor:"#ff0000"},function(t){B.document.execCommand("ForeColor",!1,t.hex),B.focus()}),n="";for(var N in i)n+='<option value ="'+i[N]+'">'+i[N]+"</option>";e.html(n),n="";for(var C in o)n+='<option value ="'+o[C]+'">'+C+"</option>";s.html(n);var B=c[0].contentWindow,D=c[0].contentWindow.document;console.log(B),D.designMode="on",D.contentEditable=!0,e.change(function(){B.document.execCommand("FontName",!1,$(this).val()),B.focus()}),s.change(function(){B.document.execCommand("FontSize",!1,parseInt($(this).val())),B.focus()}),l.on("click",function(){B.document.execCommand("Bold",!1,null),B.focus()}),a.on("click",function(){B.document.execCommand("Italic",!1,null),B.focus()}),d.on("click",function(){B.document.execCommand("justifyLeft",!1,null),B.focus()}),r.on("click",function(){B.document.execCommand("justifyCenter",!1,null),B.focus()}),f.on("click",function(){B.document.execCommand("justifyRight",!1,null),B.focus()}),h.on("click",function(){B.document.execCommand("undo",!1,null),B.focus()}),p.on("click",function(){B.document.execCommand("redo",!1,null),B.focus()}),u.on("click",function(){B.document.execCommand("indent",!1,null),B.focus()}),m.on("click",function(){B.document.execCommand("outdent",!1,null),B.focus()}),v.on("click",function(){B.document.execCommand("underline",!1,null),B.focus()}),g.on("click",function(){B.document.execCommand("strikeThrough",!1,"1"),B.focus()}),x.on("click",function(){B.document.execCommand("removeFormat",!1,"1"),B.focus()}),b.on("click",function(){w.val(""),y.css("display","block")}),I.on("click",function(){y.css("display","none")}),k.on("click",function(){y.css("display","none");console.log(w.val()),$(D.body).append('<textarea contenteditable="true" class="codeDiv" style="width: 90%;height:auto;border: 1px solid #ccc">1111</textarea>'),$(D.body).find(".codeDiv").html(w.val()),$(D.body).find(".codeDiv").css({"height:":$(D.body).find(".codeDiv").scrollHeight+"px"})})}}),$("#test_edit").panEditFrame({});